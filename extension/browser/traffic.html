<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1, maximum-scale=2, user-scalable=no" name="viewport" />
    <meta content="Penetration Testing Toolkit - chrome extension for penetration testing" name="description" />
    <meta content="Penetration Testing Toolkit, request builder, traffic recording, macro recording" name="keywords" />
    <meta content="PPType" name="author" />
    <meta content="#ffffff" name="theme-color" />
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Penetration Testing Kit - Traffic Recorder</title>
    <link rel="stylesheet" href="assets/jquery/jquery-ui.min.css" type="text/css" />
    <link rel="stylesheet" href="assets/semantic-ui/semantic.min.css" type="text/css" />
    <link rel="stylesheet" href="assets/jquery/jquery.dataTables.min.css" type="text/css" />
    <link rel="stylesheet" href="assets/codemirror/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="assets/css/default.css" type="text/css" />
    <link rel="stylesheet" href="assets/css/pandoc-code-highlight.css" type="text/css" />
    <link rel="stylesheet" href="assets/har/perf-cascade.css">

    <script src="assets/jquery/jquery.min.js"></script>
    <script src="assets/jquery/jquery.dataTables.min.js"></script>
    <script src="assets/codemirror/codemirror.js"></script>
    <script src="assets/codemirror/mode/xml/xml.js"></script>
    <script src="assets/semantic-ui/semantic.min.js"></script>
    <script src="assets/js/menu.js"></script>

    <script src="assets/js-sequence-diagrams/webfont.js"></script>
    <script src="assets/js-sequence-diagrams/snap.svg-min.js"></script>
    <script src="assets/js-sequence-diagrams/underscore-min.js"></script>
    <script src="assets/js-sequence-diagrams/sequence-diagram-min.js"></script>

    <!-- import PerfCascade JS /-->

    <script src="assets/har/perf-cascade-file-reader.js"></script>
    <script src="assets/har/perf-cascade.js"></script>


    <script src="assets/js/traffic.js"></script>
    <style>
        .signal text {
            fill: #000000;
        }

        /* .signal text:hover {
            fill: #aaaaaa
        } */

        .note rect,
        .note path {
            fill: #cecece;
        }

        .title rect,
        .title path,
        .actor rect,
        .actor path {
            fill: #ffffff
        }
    </style>
</head>

<body>
    <div id="mainMenuWrapper">
        <div class="ui inverted borderless menu">
            <img src="images/hacker_w1.png" id="ptkicon" title="Penetration Testing Kit">
            <div class="ui container" id="mainMenu"></div>
        </div>
    </div>
    <div id="content">
        <div id="controls">
            <form class="ui small form" id="traffic_form">
                <!-- request params -->
                <div class="fields" style="margin-bottom: 2px">
                    <div class="sixteen wide field" style="padding-right: 7px">
                        <input type="text" name="url" placeholder="http://domain.com OR http://127.0.0.1">
                    </div>
                </div>
                <div class="fields" style="margin-bottom: 0px">
                    <div id="trafficView" class="eleven wide field" style="padding-right: 5px;">
                        <textarea name="recording_output" id="recording_output" class="ui small input CodeMirror"
                            rows="30" placeholder="Traffic"></textarea>
                    </div>
                    <div id="diagramView" class="eleven wide field"
                        style="padding-right: 1px; overflow-x: hidden; overflow-y: scroll; height: 490px; display: none">
                        <div id="diagramSVG"></div>
                    </div>
                    <div class="five wide field" style="padding-left: 0px">
                        <div class=" content container">
                            <div class="inline fields" style="margin-bottom: 3px">
                                <div class="sixteen wide field" style="padding-right: 0px;">
                                    <div class="ui small secondary fluid button start_clean_cookie">Record
                                        authentication
                                    </div>
                                </div>
                            </div>
                            <div class="inline fields">
                                <div class="sixteen wide field" style="padding-right: 0px;">
                                    <div class="ui small secondary fluid button start">Record sequence</div>
                                </div>
                            </div>
                            <div id="auth_rating" style="display: none">
                                <h3 class="ui top attached header" style="margin-top: -1px;">Recording details</h3>
                                <div class="ui attached segment">
                                    <div class="inline fields">
                                        <div class="six wide field" style="padding-right: 1px;">Macro</div>
                                        <div class="ten wide field">
                                            <div class="ui star rating" data-rating="0" data-max-rating="5"
                                                id="macro_rating">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="inline fields">
                                        <div class="six wide field" style="padding-right: 1px;">Traffic</div>
                                        <div class="ten wide field">
                                            <div class="ui star rating" data-rating="0" data-max-rating="5"
                                                id="traffic_rating">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="inline fields">
                                        <div class="six wide field" style="padding-right: 1px;">NTLM or HTTP Basic</div>
                                        <div class="ten wide field">
                                            <div class="ui star rating" data-rating="0" data-max-rating="5"
                                                id="basic_rating">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="inline fields">
                                        <div class="six wide field" style="padding-right: 1px;">HTTP Bearer header</div>
                                        <div class="ten wide field">
                                            <div class="ui star rating" data-rating="0" data-max-rating="5"
                                                id="bearer_rating">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="inline fields">
                                        <div class="six wide field" style="padding-right: 1px;">Token</div>
                                        <div class="ten wide field">
                                            <div class="ui star rating" data-rating="0" data-max-rating="5"
                                                id="token_rating">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="menu" style="padding: 0px;margin-bottom: -21px">
                                <button type="button" class="ui small secondary fluid button analyze right floated"
                                    style="display: none">Analyze </button>

                                <button type="button" class="ui small secondary fluid button traffic_export"
                                    style="display: none">Export</button>
                                <div class="inline fields" style="margin-bottom: 3px">
                                    <div class="sixteen wide field" style="padding-right: 0px;">
                                        <button type="button"
                                            class="ui small secondary fluid button harview right floated">Show HAR
                                            view</button>
                                    </div>
                                </div>
                                <div class="inline fields" style="margin-bottom: 3px">
                                    <div class="sixteen wide field" style="padding-right: 0px;">
                                        <button type="button"
                                            class="ui right floated secondary fluid button traffic_download small ">Download</button>
                                    </div>
                                </div>
                                <div class="inline fields">
                                    <div class="sixteen wide field" style="padding-right: 0px;">
                                        <button type="button"
                                            class="ui small  fluid button reset_recording">Reset</button>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="ui mini modal">
        <div class="header">Operation error</div>
        <div class="content">
            <span id="traffic_error_message"></span>
        </div>
        <div class="actions">
            <div class="ui approve button">Close</div>
        </div>
    </div>
    <div id="dialogHarView" class="ui modal" style="display: none">
        <i class="close icon"></i>
        <div class="header">HAR view</div>
        <div class="content" style="min-height: 400px">
            <div id="harView" class="eleven wide field"
                style="padding-right: 1px; overflow-x: hidden; overflow-y: scroll; height: 490px;">

                <div id="legendHolder"></div>
                <input type="file" id="fileinput" />
                <select id="page-selector" class="page-selector"></select>
                <div id="output" class="output"></div>


                <!-- fetch polyfill for dev-page only -->
                <!--script src="/node_modules/whatwg-fetch/fetch.js"></script-->


            </div>

        </div>
    </div>
</body>

</html>
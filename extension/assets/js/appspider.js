
try {
    // AppSpider Pro reports validate button
    if (document.head.childNodes[1].httpEquiv === "NTORender-Type") {
        var validateBtnNodeList = document.querySelectorAll('[src="images/button_validate.png"]');
        for (var i = 0; i < validateBtnNodeList.length; i++) {
            var item = validateBtnNodeList[i],
                cloneItem = item.cloneNode(true);
            item.parentNode.replaceChild(cloneItem, item);
        }
    }

    //AppSpider Enterprise validate button
    if (document.head.innerHTML.indexOf('AppSpiderEnterprise')) {
        var validateBtnNodeList = document.querySelectorAll('button.ValidateApplet');
        for (var i = 0; i < validateBtnNodeList.length; i++) {
            var item = validateBtnNodeList[i],
                cloneItem = item.cloneNode(true);
            item.parentNode.replaceChild(cloneItem, item);
        }
    }

    appletStart = function (e, szConnection, refAltValidate, bAbsolutelyNeedsApplet, szProtocol, nPort, szHTTPRequests) {
        var message = {
            messageType: 'AppSpiderMessage',
            channelName: 'pentestkitAppSpiderValidateChannel',
            data: {
                function: 'validate',
                parameters: { encoded_http_request: szHTTPRequests }
            }
        };
        window.postMessage(message, '*');
    }
} catch (e) { }

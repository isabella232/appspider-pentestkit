<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
	<head>
		<title>Test Site</title>
	    <script>
            document.addEventListener("AppSpiderPluginInstalled", function (data) {
                alert('installed ' + data.detail.version);
            });

    	    function isPluginInstalled() {
    	        window.postMessage({
    	                messageType: 'AppSpiderMessage',
    	                data: {
    	                    function: 'getVersion',
    	                    parameters: {
    	                        eventName: 'AppSpiderPluginInstalled'
    	                    }
    	                }
    	            },
    	            '*');
    	    }

    	    function setMacroPlugin() {
    	        window.postMessage({
    	                messageType: 'AppSpiderMessage',
    	                data: {
    	                    function: 'setPlugin',
    	                    parameters: {
    	                        plugin: 'macro'
    	                    }
    	                }
    	            },
    	            '*');
    	    }
		
    	    function startRecording(url) {
    	        setMacroPlugin();
    	        var mesage = {
    	            messageType: 'AppSpiderMessage',
    	            channelName: 'AppSpiderMacro',
    	            data: {
    	                function: 'start',
    	                start_url: document.getElementById('startUrl').value
    	            }
    	        };
    	        window.postMessage(mesage,'*');
    	    }
			
    	    function stopRecording() {
    	        var mesage = {
    	            messageType: 'AppSpiderMessage',
    	            channelName: 'AppSpiderMacro',
    	            data: {
    	                function: 'stop',
                        clear: true,
                        url: document.getElementById('startUrl').value
    	            }
    	        };
    	        window.postMessage(mesage,'*');
    	    }
			
			
    	    function resetRecording() {
    	        var mesage = {
    	            messageType: 'AppSpiderMessage',
    	            channelName: 'AppSpiderMacro',
    	            data: {
    	                function: 'reset'
    	            }
    	        };
    	        window.postMessage(mesage,'*');
    	    }
			
			
    	    function exportRecording() {
    	        document.getElementById('export').value = "";
    	        var mesage = {
    	            messageType: 'AppSpiderMessage',
    	            channelName: 'AppSpiderMacro',
    	            data: {
    	                function: 'export',
    	                exportId: 'export'
    	            }
    	        };
    	        window.postMessage(mesage,'*');
    	    }		


    	    function checkMacro() {
    	        var parser=new DOMParser();
    	        var text=document.getElementById('export').value;
    	        var xmlDoc=parser.parseFromString(text,"text/xml");

    	        if (xmlDoc.getElementsByTagName("parsererror").length>0)
    	        {
    	            //checkErrorXML(xmlDoc.getElementsByTagName("parsererror")[0]);
    	            alert(xt)
    	        }
    	        else
    	        {
    	            alert("No errors found");
    	        }
    	    }
    	</script>
	</head>
	<body >
		<table >
			<tr>
				<td align="center" style="height:50px">Macro test<td>
			</tr>
            <!--
               Tested URLs
                http://www.w3schools.com/html/tryit.asp?filename=tryhtml_radio 
				
            -->
						<tr
						<td>Type URL:</td>
							<td colspan="3"><input type="text" id="startUrl"/></textarea></td>
						</tr>
						<tr>
							<td ><input type="button" onclick="startRecording('http://www.w3schools.com/html/tryit.asp?filename=tryhtml_radio');" id="recordAppSpiderMacro" value="Start recording"></td>
							<td ><input type="button" onclick="stopRecording();" value="Stop recording"></td>
							<td ><input type="button" onclick="resetRecording();" value="Restart"></td>
							<td ><input type="button" onclick="exportRecording();" value="Export"></td>
						    <td><input type="button" onclick="checkMacro();" value="Check macro"></td>
                            <td><input type="button" onclick="isPluginInstalled();" value="Check plugin installed"></td>
						</tr>

						<tr>
							<td colspan="4"><textarea id="export" rows="30" cols="80"></textarea></td>
						</tr>


<img border="0" src="http://www.mightyseek.com/images/spacer.gif" />

						<tr style="height:20%; vertical-align:top">
							<td align="center"><font color="grey" size="-2"></font>
						</tr>
						
						<tr style="height:10%; vertical-align:top">
							<td align="center"><a href="/privacy.php"><font color="#FFFFFF"></font></a></td>
						</tr>

		</table>
<img border="0" src="http://www.mightyseek.com/images/spacer.gif" />
<img border="0" src="http://www.mightyseek.com/images/spacer.gif" />		
	</body>
</html>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>PenTestKit Bootstrap Test Page</title>
</head>

<body>
    <h2>Bootstrap</h2>
    <div id="bootstrap">
        <script>
            function startListeningAsIAS() {
                var startListening = {
                    messageType: 'AppSpiderMessage',
                    channelName: 'AppSpiderBootstrap',
                    data: {
                        function: 'startListening',
                        parameters: {
                            start_url: document.getElementById('start-url').value,
                            jobID: document.getElementById('jobId').value,
                            restAPI: document.getElementById('restApi').value,
                            usePut: true,
                            putParams: {
                                fileName: "bootstrap-file.har",
                                headers: {
                                    "R7-Org-Product-Token": "8D6B9124BF92DD2BA122",
                                    "X-XSRF-TOKEN": "5bdb8761-1dc6-4206-8a82-58c1974e31a2"

                                }
                            }
                        }
                    }
                };
                window.postMessage(startListening, '*');
            }
            function startListening() {
                var startListening = {
                    messageType: 'AppSpiderMessage',
                    channelName: 'AppSpiderBootstrap',
                    data: {
                        function: 'startListening',
                        parameters: {
                            start_url: document.getElementById('start-url').value,
                            jobID: document.getElementById('jobId').value,
                            restAPI: document.getElementById('restApi').value
                        }
                    }
                };
                window.postMessage(startListening, '*');
            }
            function stopListening() {
                var stopListening = {
                    messageType: 'AppSpiderMessage',
                    channelName: 'AppSpiderBootstrap',
                    data: {
                        function: 'stopListening'
                    }
                };
                window.postMessage(stopListening, '*');
            }

            function exportTraffic() {
                var sendTraffic = {
                    messageType: 'AppSpiderMessage',
                    channelName: 'AppSpiderBootstrap',
                    data: {
                        function: 'sendTraffic'
                    }
                };
                window.postMessage(sendTraffic, '*');
            }

            function reset() {
                window.postMessage({
                    messageType: 'AppSpiderMessage',
                    channelName: 'AppSpiderBootstrap',
                    data: {
                        function: 'reset'
                    }
                }, '*');
            }
        </script>

        <div id="bootstrap-inputs">
            <div class="test-input">
                <label for="start-url">Starting Url</label>
                <input id="start-url" type="text" placeholder="Starting url" value="http://webscantest.com">
            </div>
            <div class="test-input">
                <label for="jobId">Job ID</label>
                <input id="jobId" type="text" placeholder="Job Id" value="1234">
            </div>
            <div class="test-input">
                <label for="restApi">Rest Api</label>
                <input id="restApi" type="text" placeholder="Rest API" value="http://restapi">
            </div>
            <div class="test-input">
                <label for="startListeningAsIAS">1. </label>
                <button id="startListeningAsIAS">Start Listening as insightAppSec</button>
            </div>
            <div class="test-input">
                <label for="startListening">2. </label>
                <button id="startListening">Start Listening as ASE</button>
            </div>
            <div class="test-input">
                <label for="stopListening">3. </label>
                <button id="stopListening">Stop Listening</button>
            </div>
            <div class="test-input">
                <label for="exportTraffic">4. </label>
                <button id="exportTraffic">Send Traffic - ASE</button>
            </div>
            <br>
            <div class="test-input">
                <label for="reset"></label>
                <button id="reset">Reset</button>
            </div>
        </div>
        <script>
            document.getElementById('startListeningAsIAS').addEventListener('click', startListeningAsIAS);
            document.getElementById('startListening').addEventListener('click', startListening);
            document.getElementById('stopListening').addEventListener('click', stopListening);
            document.getElementById('exportTraffic').addEventListener('click', exportTraffic);
            document.getElementById('reset').addEventListener('click', reset);
        </script>
    </div>
    <br>
    <h2>Macro</h2>
    <div id="macro">
        <script>
            function setPluginToMacro() {
                window.postMessage({
                    messageType: 'AppSpiderMessage',
                    channelName: 'AppSpiderMacro',
                    data: {
                        function: 'setPlugin',
                        parameters: {
                            plugin: 'macro'
                        }
                    }
                }, '*');
            }
        </script>
    </div>
</body>

</html>